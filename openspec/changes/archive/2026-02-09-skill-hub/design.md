## Architecture

### ClawHub æ•´åˆæ–¹å¼

å…©ç¨®é¸æ“‡ï¼š

**æ–¹æ¡ˆ Aï¼šCLI æ•´åˆï¼ˆå»ºè­°ï¼‰**
```
CTOS Backend â†’ subprocess("clawhub search ...") â†’ è§£æ stdout
CTOS Backend â†’ subprocess("clawhub install ...") â†’ ä¸‹è¼‰åˆ° skills/
```
- å„ªé»ï¼šç°¡å–®ã€ä¸éœ€é€†å‘ APIã€è‡ªå‹•è™•ç†èªè­‰
- ç¼ºé»ï¼šéœ€è¦å®‰è£ clawhub CLIï¼ˆnpm/node ä¾è³´ï¼‰

**æ–¹æ¡ˆ Bï¼šHTTP API ç›´æ¥å‘¼å«**
```
CTOS Backend â†’ requests.get("https://api.clawhub.com/...") â†’ ä¸‹è¼‰ .skill zip
```
- å„ªé»ï¼šä¸éœ€ npm/node
- ç¼ºé»ï¼šAPI å¯èƒ½æœªå…¬é–‹æ–‡ä»¶ã€éœ€è¦è‡ªå·±è™•ç†èªè­‰

**æ±ºå®šï¼šå…ˆç”¨æ–¹æ¡ˆ A**ï¼Œå¾ŒçºŒå¦‚æœ ClawHub å…¬é–‹ API å†åˆ‡æ›ã€‚

### SKILL.md å¯«å›æ ¼å¼

ç·¨è¼¯ metadata.ctos æ™‚ï¼Œåªæ›´æ–° frontmatterï¼Œä¿ç•™ body ä¸å‹•ï¼š

```python
def update_skill_metadata(name, requires_app, allowed_tools, mcp_servers):
    skill_md = skills_dir / name / "SKILL.md"
    text = skill_md.read_text()
    config, body = _parse_skill_md(text)
    
    # æ›´æ–° CTOS æ“´å……æ¬„ä½
    config.setdefault("metadata", {}).setdefault("ctos", {})
    config["metadata"]["ctos"]["requires_app"] = requires_app
    config["metadata"]["ctos"]["mcp_servers"] = " ".join(mcp_servers)
    
    # æ›´æ–° allowed-tools
    config["allowed-tools"] = " ".join(allowed_tools)
    
    # å¯«å›
    fm_text = yaml.dump(config, ...)
    skill_md.write_text(f"---\n{fm_text}\n---\n\n{body}\n")
```

### å‰ç«¯ UI è¨­è¨ˆ

```
â”Œâ”€ Skills ç®¡ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å·²å®‰è£ (7)]  [ClawHub æœå°‹]                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                  â”‚
â”‚  å·²å®‰è£ tab:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ base         åŸºç¤    â”‚ â”‚ åç¨±: base       â”‚  â”‚
â”‚  â”‚ ai-assistant ğŸ·ï¸ AI  â”‚ â”‚ èªªæ˜: åŸºç¤å·¥å…·...  â”‚  â”‚
â”‚  â”‚ file-manager ğŸ·ï¸ æª”æ¡ˆâ”‚ â”‚ æ¬Šé™: åŸºç¤       â”‚  â”‚
â”‚  â”‚ inventory    ğŸ·ï¸ åº«å­˜â”‚ â”‚                    â”‚  â”‚
â”‚  â”‚ knowledge    ğŸ·ï¸ çŸ¥è­˜â”‚ â”‚ å·¥å…· (4):         â”‚  â”‚
â”‚  â”‚ printer      ğŸ·ï¸ åˆ—å°â”‚ â”‚ [get_msg_attach] â”‚  â”‚
â”‚  â”‚ project      ğŸ·ï¸ å°ˆæ¡ˆâ”‚ â”‚ [summarize_chat] â”‚  â”‚
â”‚  â”‚                      â”‚ â”‚                    â”‚  â”‚
â”‚  â”‚                      â”‚ â”‚ [âœï¸ ç·¨è¼¯] [ğŸ—‘ï¸]   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”‚  ClawHub æœå°‹ tab:                               â”‚
â”‚  ğŸ” [æœå°‹ skill...        ] [æœå°‹]              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ pr-reviewer v1.0.0          [å®‰è£]      â”‚    â”‚
â”‚  â”‚ PR code review with diff analysis       â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚    â”‚
â”‚  â”‚ ai-code-review v1.0.1      [å®‰è£]      â”‚    â”‚
â”‚  â”‚ Code review assistant                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API è¨­è¨ˆ

```
GET    /api/skills                          # åˆ—å‡ºå·²å®‰è£
GET    /api/skills/{name}                   # è©³æƒ…
PUT    /api/skills/{name}                   # ç·¨è¼¯ metadata.ctos + allowed-tools
DELETE /api/skills/{name}                   # ç§»é™¤
POST   /api/skills/reload                   # é‡è¼‰
GET    /api/skills/{name}/files/{path}      # è®€å–æª”æ¡ˆ
POST   /api/skills/hub/search?q=...        # æœå°‹ ClawHub
POST   /api/skills/hub/install             # å®‰è£ ClawHub skill
```

### å®‰å…¨æ¨¡å‹

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ClawHub Skill     â”‚
                    â”‚  (å¤–éƒ¨ï¼Œä¸ä¿¡ä»»)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ install
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CTOS Skills Dir   â”‚
                    â”‚  requires_app: nullâ”‚ â† é è¨­ç„¡æ¬Šé™
                    â”‚  allowed-tools: "" â”‚ â† é è¨­ç„¡å·¥å…·
                    â”‚  mcp_servers: ""   â”‚ â† é è¨­ç„¡ MCP
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ ç®¡ç†å“¡æ‰‹å‹•æˆæ¬Š
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å·²æˆæ¬Š Skill      â”‚
                    â”‚  requires_app: xxx â”‚
                    â”‚  allowed-tools: ...â”‚
                    â”‚  mcp_servers: ...  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

å®‰è£çš„ skill é è¨­æ˜¯ã€Œç¦ç”¨ã€ç‹€æ…‹ï¼ˆæ²’æœ‰å·¥å…·ç™½åå–® = AI ä¸æœƒä½¿ç”¨ï¼‰ï¼Œ
ç®¡ç†å“¡å¿…é ˆæ‰‹å‹•åˆ†é…æ¬Šé™æ‰æœƒç”Ÿæ•ˆã€‚
